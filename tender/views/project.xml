<?xml version="1.0"?>
<odoo>
    <record id="constaction_tender_tree" model="ir.ui.view">
        <field name="name">constaction_tender_tree</field>
        <field name="model">construction.tender</field>
        <field name="priority">1</field>
        <field name="arch" type="xml">
            <tree sample="1" multi_edit="1">
                <field name="code" required="1"/>
                <!--                <field name="parent_item"/>-->
                <field name="item" required="1"/>
                <field name="name" required="1"/>
                <field name="uom_id"/>
                <field name="qty"/>

                <field name="state" readonly="1"/>

                <!--                <field name="price_unit"/>-->
                <!--                <field name="total_value"/>-->

            </tree>
        </field>
    </record>
    <record id="view_project_form" model="ir.ui.view">
        <field name="name">constaction_project_form</field>
        <field name="model">project.project</field>
        <field name="inherit_id" ref="project.edit_project"/>
        <!--        <field name="priority">1000</field>-->
        <field name="arch" type="xml">

            <xpath expr="//header/button[last()]" position="after">
                <field name="type" invisible="1"/>
                <button string="Create Break Down" name="create_job_ct" type="object"/>
                <button string="Create Financial Offer" name="create_quotation" type="object"/>
                <button string="Confirm as Project" name="confirm_as_project" type="object"
                        attrs="{'invisible':[('type','=','project')]}"/>

            </xpath>


            <xpath expr="//div[@name='button_box']" position="inside">
                <field name="is_quotation" invisible="1"/>

                <button class="oe_stat_button" name="view_quotation" type="object" icon="fa-file-text-o"
                        attrs="{'invisible':[('is_quotation','=',False)]}">
                    <field string="Quotations" name="quotation_count" widget="statinfo"/>
                </button>
                <button class="oe_stat_button" name="view_job_cost" type="object" icon="fa-tasks">
                    <field string="Estimations" name="job_cost_count" widget="statinfo"/>
                </button>
                <button class="oe_stat_button" name="upload_tender" type="object" icon="fa-tasks">
                    Upload Tender
                </button>
            </xpath>
            <xpath expr="//h1" position="after">
                <group>
                    <group>
                        <field name="name"/>
                        <field name="project_number"/>
                        <field name="project_reference"/>
                        <!--    <field name="parent_id" />-->
                        <!--                        <field name="partner_id" required="1"/>-->
                    </group>
                    <group>

                        <button name="update_ratio_currancy" type="object" string="Update Currancy"/>

                    </group>
                </group>
            </xpath>
            <xpath expr="//notebook/page[1]" position="before">
                <page string="Tender">
                    <field name="tender_ids" widget="section_and_note_one2many">
                        <form>
                            <field name="display_type" invisible="1"/>
                            <group>
                                <group>
                                    <field name="code" required="1"/>

                                    <field name="item" required="1"/>
                                    <field name="name" required="1"/>
                                    <field name="uom_id"/>
                                </group>
                                <group>
                                    <field name="state" readonly="1"/>
                                    <field name="qty"/>
                                    <field name="price_unit" readonly="1"/>
                                    <field name="total_value"/>
                                    <field name="sale_price"/>
                                    <!--                                    <field name="parent_item" required="1"/>-->
                                    <field name="notes"/>
                                </group>
                            </group>
                        </form>
                        <tree editable="bottom" string="Contract Order Lines">

                            <control>
                                <create name="add_product_control" string="Add a product"/>
                                <create name="add_section_control" string="Add a section"
                                        context="{'default_display_type': 'line_section'}"/>
                                <create name="add_note_control" string="Add a note"
                                        context="{'default_display_type': 'line_note'}"/>
                            </control>
                            <field name="display_type" invisible="1" optional="show"/>
                            <field name="sequence" widget="handle" optional="show"/>





                            <field name="code"  attrs="{'required': [('display_type', '=', False)]}" optional="show"/>
                            <!--                            <field name="parent_item"/>-->
                            <field name="item"  attrs="{'required': [('display_type', '=', False)]}" optional="show"/>
                            <field name="name"  attrs="{'required': [('display_type', '=', False)]}"
                                   widget="section_and_note_text"
                                   optional="show" />
                            <field name="related_job" optional="show"/>
                            <field name="uom_id" optional="show"/>
                            <field name="qty" optional="show" sum="total"/>
                            <field name="tax_id" optional="show"/>

                            <field name="state" readonly="1"/>

                            <field name="price_unit" readonly="1" sum="total"/>
                            <field name="total_value" optional="show" sum="total"/>
                            <field name="indirect_cost"  optional="show" sum="total"/>
                            <field name="profit"   optional="show" sum="total"/>
                            <field name="sale_price"  optional="show" sum="total"/>
                            <!--                                    <field name="parent_item" required="1"/>-->

                            <field name="notes"/>

                        </tree>

                    </field>
                </page>
                <page string="Currancy">
                    <group>
                        <field name="currancy_ids">
                            <tree editable="top">
                                <field name="currancy_id"/>
                                <field name="ratio" string="Rate"/>

                            </tree>
                        </field>
                    </group>
                </page>
                <page name="other_info" string="Other info">
                    <group>
                        <group>
                            <field name="created_date"/>
                            <field name="consultant"/>
                            <field name="manager_id"/>
                            <field name="company_id" invisible="1"/>
                            <field name="date_from"/>
                            <field name="date_to"/>
                            <field name="dif"/>
                        </group>
                        <group>
                            <field name="date_contract"/>
                            <field name="tender_submission_date"/>
                            <field name="location_acquisition_date"/>
                            <field name="analytic_account"/>
                            <field name="currancy_id" invisible="1"/>
                        </group>

                    </group>
                </page>
            </xpath>


            <!--            <xpath expr="//div[@name='button_box']" position="attributes">-->
            <!--                <attribute name="invisible">[('type','!=','project')]</attribute>-->

            <!--            </xpath>-->


        </field>
    </record>


</odoo>